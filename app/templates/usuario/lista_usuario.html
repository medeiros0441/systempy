{% extends 'base.html' %}

{% block title %}Lista de Usuários{% endblock %}

{% block content %}
{% include 'usuario/modal_usuario.html' %}
{% include 'configuracao/modal_configuracao.html' %}

<div class="my-5 container-xl mx-auto ">
    <div class="d-flex justify-content-between">
        <div>
            <h2 class=" font-monospace fw-border my-auto" style="font-size: 1.3rem;">Lista de Usuários</h2>
        </div>
        <div class="d-flex align-items-center">
            <a href="{% url 'cadastrar_usuario' %}" class="btn text-secondary border-0" >
                Cadastrar Usuário 
                <i class="bi bi-plus pe-1 pt-2 d-inline-block" style="font-size: 1.3rem;"></i>
            </a>
        </div>
    </div>
    <div class="container-xl p-3  mx-auto bg-white rounded">
    
    
    <table class="table">
        <thead>
          <tr class="font-monospace text-start" style="font-size: 0.8rem;">
            <th scope="col">Nome Responsavel</th>
            <th scope="col">Status</th>
            <th scope="col">Nivel usuario</th>
            <th scope="col" class="text-end">Ações</th>
          </tr>
        </thead>
        <tbody class="table-group-divider">
        {% for usuario in usuarios %}
        <tr class="font-monospace text-start" style="font-size: 0.8rem;">
            <td scope="row">  {{ usuario.nome_completo }} </td>
            <td>
                
                {% if usuario.status_acesso %}
                    Ativo
                {% else %}
                    Desativado
                {% endif %}

           </td>
            <td>
                {% if usuario.nivel_usuario == 1 %}
                Administrador 
                {% elif usuario.nivel_usuario == 2 %}
                Gerente
            {% elif usuario.nivel_usuario == 3 %}
                Colaborador
            {% endif %}</td>
            <td class="text-end">
                <div class="btn-group" role="group" aria-label="Ações do Usuário">

                    <div class="btn-group" role="group" aria-label="Ações do Usuário">
                        <a href="{% url 'detalhes_usuario' usuario.id_usuario %}" class="btn btn-success btn-sm" style="font-size: 0.8rem;"><i  style="font-size: 0.8rem;" class="bi bi-eye me-1"></i> </a>
                    
                        <a   href="{% url 'editar_usuario' usuario.id_usuario %}" class="btn btn-primary btn-sm">
                            <i class="bi bi-pencil"></i> 
                    </a>
                        
                    {% if usuario.nivel_usuario != 1 %}
                        
                        {% if usuario.status_acesso %}
                            <a href="{% url 'bloquear_usuario' usuario.id_usuario %}" class="btn btn-warning btn-sm btn-confirmacao" 
                               data-acao="bloquear" 
                               data-titulo="Bloquear Usuário" 
                               data-descricao="Tem certeza de que deseja bloquear este usuário?">
                                <i class="bi bi-lock"></i> 
                            </a>
                        {% else %}
                            <a href="{% url 'ativar_usuario' usuario.id_usuario %}" class="btn btn-success btn-sm btn-confirmacao" 
                               data-acao="ativar" 
                               data-titulo="Ativar Usuário" 
                               data-descricao="Tem certeza de que deseja ativar este usuário?">
                                <i class="bi bi-unlock"></i> 
                            </a>
                    
                        {% endif %}

                        <a  class="btn btn-secondary btn-sm"  href="{% url 'configuracao_usuario' usuario.id_usuario %}">
                        <i class="bi bi-gear-fill"></i>
                        </a>
                        <a href="{% url 'excluir_usuario' usuario.id_usuario %}" class="btn btn-danger btn-sm btn-confirmacao" 
                           data-acao="excluir" 
                           data-titulo="Excluir Usuário" 
                           data-descricao="Tem certeza de que deseja excluir este usuário?">
                            <i class="bi bi-trash"></i> 
                        </a>
                        {% endif %}
                    </div>  </div>
                </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>

    </div>
</div>
    <script >
    {% if open_modal %}
        document.addEventListener('DOMContentLoaded', function() {
        var myModal = new bootstrap.Modal(document.getElementById('ModalUsuario'));
        myModal.show();
    });
    {% endif %}
    {% if open_modal_configuracao %}
    document.addEventListener('DOMContentLoaded', function() {
    var myModal = new bootstrap.Modal(document.getElementById('ModalConfiguracao'));
    myModal.show();
});
{% endif %}
</script>
{% endblock %}
