{% extends 'base.html' %}

{% block title %}Lista de Usuários{% endblock %}

{% block content %}
{% include 'usuario/modal_usuario.html' %}

<div class="my-5 container-xl mx-auto ">
    <div class="d-flex justify-content-between">
        <div>
            <h2 class=" font-monospace fw-border my-auto" style="font-size: 1.3rem;">Lista de Usuários</h2>
        </div>
        <div class="d-flex align-items-center">
            <a href="{% url 'cadastrar_usuario' %}" class="btn text-secondary border-0" >
                Cadastrar Usuário 
                <i class="bi bi-plus pe-1 pt-2 d-inline-block" style="font-size: 1.3rem;"></i>
            </a>
        </div>
    </div>
    
    
    <table class="table">
        <thead>
          <tr class="font-monospace text-start" style="font-size: 0.8rem;">
            <th scope="col">Nome Responsavel</th>
            <th scope="col">Status</th>
            <th scope="col">Nivel usuario</th>
            <th scope="col" class="text-end">Ações</th>
          </tr>
        </thead>
        <tbody class="table-group-divider">
        {% for usuario in usuarios %}
        <tr class="font-monospace text-start" style="font-size: 0.8rem;">
            <td scope="row">  {{ usuario.nome_completo }} </td>
            <td>
                
                {% if usuario.status_acesso %}
                    Ativo
                {% else %}
                    Desativado
                {% endif %}

           </td>
            <td>
                {% if usuario.nivel_usuario == 1 %}
                Administrador 
                {% elif usuario.nivel_usuario == 2 %}
                Gerente
            {% elif usuario.nivel_usuario == 3 %}
                Colaborador
            {% endif %}</td>
            <td class="text-end">
                <div class="btn-group" role="group" aria-label="Ações do Usuário">
                    <div class="btn-group" role="group" aria-label="Ações do Usuário">
                        <button type="button" class="btn btn-primary btn-sm" onclick="window.location.href='{% url 'editar_usuario' usuario.id_usuario %}'">
                            <i class="bi bi-pencil"></i> 
                        </button>
                        {% if usuario.nivel_usuario != 1 %}
                        <button type="button"    class="btn btn-danger btn-sm" onclick="abrirModalConfirmacao('{{ usuario.id }}', 'excluir_usuario', 'Excluir Usuário', 'Tem certeza que deseja excluir este usuário?')">
                            <i class="bi bi-trash"></i> 
                        </button>
                        
                        {% if usuario.status_acesso %}
                            <a href="{% url 'bloquear_usuario' usuario.id_usuario %}" class="btn btn-warning btn-sm">
                                <i class="bi bi-lock"></i> 
                            </a>
                        {% else %}
                            <a href="{% url 'ativar_usuario' usuario.id_usuario %}" class="btn btn-success btn-sm">
                                <i class="bi bi-unlock"></i> 
                            </a>
                        {% endif %}
                        {% endif %}
                    </div>  </div>
                </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>

    </div>
    <script >
        {% if open_modal %}
    document.addEventListener('DOMContentLoaded', function() {
        var myModal = new bootstrap.Modal(document.getElementById('ModalUsuario'));
        myModal.show();
    });
    {% endif %}
</script>
{% endblock %}
